
--CREATE TABLE AUTHORITIES
--(
--  id bigserial NOT NULL,
--  name character varying(60),
--  CONSTRAINT authorities_pkey PRIMARY KEY (id)
--)
--
--CREATE TABLE USERS
--(
--  id bigserial NOT NULL,
--  username character varying(60) NOT NULL,
--  password character varying(255) NOT NULL,
--  first_name character varying(50) NOT NULL,
--  last_name character varying(50) NOT NULL,
--  email character varying(50) NOT NULL,
--  last_password_reset_date timestamp without time zone,
--  enabled boolean,
--  CONSTRAINT users_pkey PRIMARY KEY (id),
--  CONSTRAINT uk_avh1b2ec82audum2lyjx2p1ws UNIQUE (email),
--  CONSTRAINT uk_dc4eq7plr20fdhq528twsak1b UNIQUE (username)
--)
--
--CREATE TABLE USER_AUTHORITY
--(
--  user_id bigint,
--  authority_id bigint,
--  CONSTRAINT fk_gr6xgu0wc88iatb49jedq7fa8 FOREIGN KEY (user_id)
--      REFERENCES USERS (id) MATCH SIMPLE
--      ON UPDATE NO ACTION ON DELETE NO ACTION,
--  CONSTRAINT fk_gr6xgu0wb88iatb49jedq7fa8 FOREIGN KEY (authority_id)
--  REFERENCES AUTHORITIES (id) MATCH SIMPLE
--  ON UPDATE NO ACTION ON DELETE NO ACTION
--)
--
---- the password hash is generated by BCrypt Calculator Generator(https://www.dailycred.com/article/bcrypt-calculator)
--INSERT INTO USERS (id, username, password, first_name, last_name, email, enabled) VALUES (1, 'user', '$2a$04$Vbug2lwwJGrvUXTj6z7ff.97IzVBkrJ1XfApfGNl.Z695zqcnPYra', 'Fan', 'Jin', 'fan_jin@abv.bg', 1);
--INSERT INTO USERS (id, username, password, first_name, last_name, email, enabled) VALUES (2, 'admin', '$2a$04$Vbug2lwwJGrvUXTj6z7ff.97IzVBkrJ1XfApfGNl.Z695zqcnPYra', 'Jing', 'Xiao', 'jing_xiao@abv.bg', 1);
--
--INSERT INTO AUTHORITIES (id, name) VALUES (1, 'ROLE_USER');
--INSERT INTO AUTHORITIES (id, name) VALUES (2, 'ROLE_ADMIN');
--
--INSERT INTO USER_AUTHORITY (user_id, authority_id) VALUES (1, 1);
--INSERT INTO USER_AUTHORITY (user_id, authority_id) VALUES (2, 1);
--INSERT INTO USER_AUTHORITY (user_id, authority_id) VALUES (2, 2);
--
--
--CREATE TABLE RETAILERS
--(
--  id serial NOT NULL,
--  retailer_username character varying(250),
--  url character varying(250),
--  CONSTRAINT retailers_pkey PRIMARY KEY (id),
--  CONSTRAINT unique_retailer UNIQUE (retailer_username)
--)
--
--CREATE TABLE SALES_ITEMS
--(
--  id bigserial NOT NULL,
--  item_title character varying(250),
--  price character varying(250),
--  url character varying(250),
--  retailer_id integer,
--  picture character varying(250),
--  sale_date timestamp without time zone,
--  times_sold integer,
--  upc character varying(250),
--  amazon_url character varying(250),
--  amazon_picture character varying(250),
--  CONSTRAINT salesitems_pkey PRIMARY KEY (id),
--  CONSTRAINT unique_url UNIQUE (url),
--  CONSTRAINT fk_gr6xgu0wc31iatb49jedq7fa8 FOREIGN KEY (retailer_id)
--      REFERENCES retailers (id) MATCH SIMPLE
--      ON UPDATE NO ACTION ON DELETE NO ACTION
--)
--
--CREATE TABLE USERS_RETAILERS
--(
--  id serial NOT NULL,
--  is_visible boolean,
--  retailer_id integer,
--  user_id bigint,
--  is_dropshipper boolean,
--  CONSTRAINT users_retailers_pkey PRIMARY KEY (id),
--  CONSTRAINT fk_11w8bhoyq4w1vl6j0thjxf53a FOREIGN KEY (retailer_id)
--      REFERENCES retailers (id) MATCH SIMPLE
--      ON UPDATE NO ACTION ON DELETE NO ACTION,
--  CONSTRAINT fk_d1wq9xxxix9fv05ho9xpylasj FOREIGN KEY (user_id)
--      REFERENCES users (id) MATCH SIMPLE
--      ON UPDATE NO ACTION ON DELETE NO ACTION
--)
--
--ALTER TABLE USERS_RETAILERS ADD UNIQUE (retailer_id, user_id);
--
--CREATE TABLE USERS_SALESITEMS
--(
--  id serial NOT NULL,
--  is_visible boolean,
--  salesitem_id bigint,
--  user_id bigint,
--  CONSTRAINT users_salesitems_pkey PRIMARY KEY (id),
--  CONSTRAINT fk_9htlc0kwqcx5mxoqjeiilk6xu FOREIGN KEY (user_id)
--      REFERENCES users (id) MATCH SIMPLE
--      ON UPDATE NO ACTION ON DELETE NO ACTION,
--  CONSTRAINT fk_avexl9hai2bpsufq7is8luevf FOREIGN KEY (salesitem_id)
--      REFERENCES sales_items (id) MATCH SIMPLE
--      ON UPDATE NO ACTION ON DELETE NO ACTION
--)
--
--ALTER TABLE USERS_SALESITEMS ADD UNIQUE (salesitem_id, user_id);
--
--CREATE TABLE ANONYMOUS_PROXY
--(
--  id serial NOT NULL,
--  host character varying(250),
--  port bigint
--  CONSTRAINT anonymous_proxy_pkey PRIMARY KEY (id)
--)
--
--
--create table CRAWLER_LOCK (
--  id character varying(250)
--);
--
--ALTER TABLE CRAWLER_LOCK ADD UNIQUE (id);
--
--ALTER TABLE CRAWLER_LOCK ADD PRIMARY KEY (id);
--
--SET transaction ISOLATION LEVEL READ UNCOMMITTED;
--
--or go to C:\Program Files\PostgreSQL\9.3\data\postgresql.conf and change postgresql.conf file : default_transaction_isolation = 'read uncommitted'
--
--Restart databse
--CREATE OR REPLACE FUNCTION aquire_lock(i_id varchar(100)) RETURNS VOID AS
--$$
--BEGIN
--    INSERT INTO CRAWLER_LOCK (id) VALUES (i_id);
--    DELETE FROM CRAWLER_LOCK WHERE id = i_id;
--END
--$$
--  LANGUAGE 'plpgsql';
--
--
--sudo service postgresql restart in folder /etc/intit.d